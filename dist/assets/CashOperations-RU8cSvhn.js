import{j as e}from"./query-D2a9LsAW.js";import{r as s}from"./vendor-Ba6jih-_.js";import{e as W}from"./exportToCsv-CTUkvpR5.js";import{D as Z}from"./DataTable-Dzg2kqPW.js";import{M as ee}from"./Modal-BazkrsRl.js";import{S as f}from"./StatCard-R_-DmWX7.js";import{u as te,t as ae,o as se,s as c,n as re,e as le}from"./types-Vcb-PP2J.js";import{V as k}from"./index-v3sBR1NV.js";import{ab as O,T as G,aC as I,aJ as ne,d as oe,S as ie,aa as ce,r as de,R as me,X as pe,aI as E,ak as ue,ao as xe,aw as he}from"./ui-yrixFDMZ.js";const ge=se({operation_type:le(["income","expense","transfer"],{message:"İşlem türü seçiniz"}),amount:re().min(.01,"Geçerli bir tutar giriniz"),description:c().min(1,"Açıklama giriniz"),category:c().min(1,"Kategori seçiniz"),reference_number:c().optional(),from_account:c().optional(),to_account:c().optional(),notes:c().optional()}),be={income:["Bağış Geliri","Faiz Geliri","Kira Geliri","Diğer Gelirler"],expense:["Nakdi Yardım","Personel Gideri","Kira Gideri","Elektrik-Su","Telefon-İnternet","Kırtasiye","Diğer Giderler"],transfer:["Hesap Arası Transfer","Banka Transfer","Kasa Transfer"]};function _e(){var C;const[v,w]=s.useState([]),[m,F]=s.useState({totalIncome:0,totalExpense:0,balance:0,todayOperations:0}),[A,B]=s.useState(!0),[o,M]=s.useState(""),[p,R]=s.useState("all"),[u,Y]=s.useState("all"),[x,z]=s.useState("all"),[K,i]=s.useState(!1),[S,T]=s.useState(null),{register:l,handleSubmit:L,formState:{errors:n},reset:H,watch:U}=te({resolver:ae(ge)}),h=U("operation_type");s.useEffect(()=>{P(),_()},[]);const P=async()=>{try{const t=[{id:"1",operation_type:"income",amount:5e4,description:"Aylık bağış geliri",category:"Bağış Geliri",reference_number:"REF001",operator_id:"user1",operation_date:new Date().toISOString(),status:"completed",created_at:new Date().toISOString(),operator:{name:"Admin User",email:"admin@example.com"}},{id:"2",operation_type:"expense",amount:15e3,description:"Nakdi yardım ödemesi",category:"Nakdi Yardım",reference_number:"REF002",operator_id:"user1",operation_date:new Date().toISOString(),status:"completed",created_at:new Date().toISOString(),operator:{name:"Admin User",email:"admin@example.com"}}];w(t)}catch(t){console.error("Nakdi işlemler yüklenirken hata:",t),k.error("Nakdi işlemler yüklenirken hata oluştu")}finally{B(!1)}},_=async()=>{try{F({totalIncome:15e4,totalExpense:85e3,balance:65e3,todayOperations:5})}catch(t){console.error("İstatistikler yüklenirken hata:",t)}},N=s.useMemo(()=>v.filter(t=>{var D;const r=o===""||t.description.toLowerCase().includes(o.toLowerCase())||t.category.toLowerCase().includes(o.toLowerCase())||((D=t.reference_number)==null?void 0:D.toLowerCase().includes(o.toLowerCase())),a=p==="all"||t.operation_type===p,d=u==="all"||t.status===u;let b=!0;if(x!=="all"){const y=new Date(t.operation_date),j=new Date;switch(x){case"today":{b=y.toDateString()===j.toDateString();break}case"week":{const X=new Date(j.getTime()-6048e5);b=y>=X;break}case"month":{b=y.getMonth()===j.getMonth()&&y.getFullYear()===j.getFullYear();break}}}return r&&a&&d&&b}),[v,o,p,u,x]),$=async t=>{try{const r={id:Date.now().toString(),...t,operator_id:"current_user",operation_date:new Date().toISOString(),status:"completed",created_at:new Date().toISOString(),operator:{name:"Current User",email:"user@example.com"}};w(a=>[r,...a]),k.success("Nakdi işlem başarıyla kaydedildi"),i(!1),H(),_()}catch(r){console.error("Nakdi işlem kaydedilirken hata:",r),k.error("Nakdi işlem kaydedilirken hata oluştu")}},Q=t=>{const a={income:{label:"Gelir",class:"bg-green-100 text-green-800",icon:G},expense:{label:"Gider",class:"bg-red-100 text-red-800",icon:I},transfer:{label:"Transfer",class:"bg-blue-100 text-blue-800",icon:de}}[t]||{label:t,class:"bg-gray-100 text-gray-800",icon:me},d=a.icon;return e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium ${a.class}`,children:[e.jsx(d,{className:"h-3 w-3"}),a.label]})},V=t=>{const a={pending:{label:"Beklemede",class:"bg-yellow-100 text-yellow-800",icon:ue},completed:{label:"Tamamlandı",class:"bg-green-100 text-green-800",icon:E},cancelled:{label:"İptal Edildi",class:"bg-red-100 text-red-800",icon:pe}}[t]||{label:t,class:"bg-gray-100 text-gray-800",icon:E},d=a.icon;return e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium ${a.class}`,children:[e.jsx(d,{className:"h-3 w-3"}),a.label]})},g=t=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(t),q=t=>new Date(t).toLocaleDateString("tr-TR"),J=[{key:"operation_type",header:"İşlem Türü",render:t=>Q(t.operation_type)},{key:"description",header:"Açıklama",render:t=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.description}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t.category})]})},{key:"amount",header:"Tutar",render:t=>e.jsxs("div",{className:`font-medium ${t.operation_type==="income"?"text-green-600":t.operation_type==="expense"?"text-red-600":"text-blue-600"}`,children:[t.operation_type==="income"?"+":t.operation_type==="expense"?"-":"",g(t.amount)]})},{key:"reference_number",header:"Referans No",render:t=>t.reference_number||"-"},{key:"operation_date",header:"İşlem Tarihi",render:t=>q(t.operation_date)},{key:"status",header:"Durum",render:t=>V(t.status)},{key:"operator",header:"İşlem Yapan",render:t=>{var r;return((r=t.operator)==null?void 0:r.name)||"-"}},{key:"actions",header:"İşlemler",render:t=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"rounded p-1 text-gray-600 hover:bg-gray-50",title:"Detay",children:e.jsx(xe,{className:"h-4 w-4"})}),t.status==="pending"&&e.jsx("button",{onClick:()=>{T(t),i(!0)},className:"rounded p-1 text-blue-600 hover:bg-blue-50",title:"Düzenle",children:e.jsx(he,{className:"h-4 w-4"})})]})}];return A?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"Yükleniyor..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Nakdi Yardım İşlemleri"}),e.jsx("p",{className:"text-muted-foreground",children:"Nakdi işlemleri kaydedin ve takip edin"})]}),e.jsxs("button",{onClick:()=>{T(null),i(!0)},className:"flex items-center gap-2 rounded bg-primary px-4 py-2 text-sm text-white hover:bg-primary/90",children:[e.jsx(O,{className:"h-4 w-4"}),"Yeni İşlem"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(f,{title:"Toplam Gelir",value:g(m.totalIncome),icon:e.jsx(G,{className:"h-5 w-5 text-green-700"}),accentClass:"bg-green-100"}),e.jsx(f,{title:"Toplam Gider",value:g(m.totalExpense),icon:e.jsx(I,{className:"h-5 w-5 text-red-700"}),accentClass:"bg-red-100"}),e.jsx(f,{title:"Bakiye",value:g(m.balance),icon:e.jsx(ne,{className:"h-5 w-5 text-blue-700"}),accentClass:"bg-blue-100"}),e.jsx(f,{title:"Bugünkü İşlemler",value:m.todayOperations.toString(),icon:e.jsx(oe,{className:"h-5 w-5 text-purple-700"}),accentClass:"bg-purple-100"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"İşlem ara...",value:o,onChange:t=>M(t.target.value),className:"min-w-64 rounded border px-3 py-2 text-sm"})]}),e.jsxs("select",{value:p,onChange:t=>R(t.target.value),className:"rounded border px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"Tüm Türler"}),e.jsx("option",{value:"income",children:"Gelir"}),e.jsx("option",{value:"expense",children:"Gider"}),e.jsx("option",{value:"transfer",children:"Transfer"})]}),e.jsxs("select",{value:u,onChange:t=>Y(t.target.value),className:"rounded border px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"Tüm Durumlar"}),e.jsx("option",{value:"pending",children:"Bekleyen"}),e.jsx("option",{value:"completed",children:"Tamamlanan"}),e.jsx("option",{value:"cancelled",children:"İptal Edilen"})]}),e.jsxs("select",{value:x,onChange:t=>z(t.target.value),className:"rounded border px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"Tüm Tarihler"}),e.jsx("option",{value:"today",children:"Bugün"}),e.jsx("option",{value:"week",children:"Bu Hafta"}),e.jsx("option",{value:"month",children:"Bu Ay"})]}),e.jsxs("button",{onClick:()=>W("nakdi-islemler.csv",N),className:"flex items-center gap-2 rounded bg-green-600 px-3 py-2 text-sm text-white hover:bg-green-700",children:[e.jsx(ce,{className:"h-4 w-4"}),"İndir"]}),e.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[N.length," işlem"]})]}),e.jsx(Z,{columns:J,data:N}),e.jsxs(ee,{open:K,onClose:()=>i(!1),children:[e.jsxs("div",{className:"flex items-center justify-between border-b p-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:S?"İşlem Düzenle":"Yeni Nakdi İşlem"}),e.jsx("button",{onClick:()=>i(!1),className:"h-8 w-8 rounded-full bg-red-600 text-white hover:bg-red-700",children:"×"})]}),e.jsxs("form",{onSubmit:L($),className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"İşlem Türü *"}),e.jsxs("select",{...l("operation_type"),className:"w-full rounded border px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Seçiniz..."}),e.jsx("option",{value:"income",children:"Gelir"}),e.jsx("option",{value:"expense",children:"Gider"}),e.jsx("option",{value:"transfer",children:"Transfer"})]}),n.operation_type&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.operation_type.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kategori *"}),e.jsxs("select",{...l("category"),className:"w-full rounded border px-3 py-2 text-sm",disabled:!h,children:[e.jsx("option",{value:"",children:"Seçiniz..."}),h&&((C=be[h])==null?void 0:C.map(t=>e.jsx("option",{value:t,children:t},t)))]}),n.category&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.category.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tutar *"}),e.jsx("input",{type:"number",step:"0.01",...l("amount",{valueAsNumber:!0}),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"0.00"}),n.amount&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.amount.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Referans Numarası"}),e.jsx("input",{type:"text",...l("reference_number"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"REF001"})]})]}),h==="transfer"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kaynak Hesap"}),e.jsx("input",{type:"text",...l("from_account"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"Kaynak hesap"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hedef Hesap"}),e.jsx("input",{type:"text",...l("to_account"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"Hedef hesap"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Açıklama *"}),e.jsx("input",{type:"text",...l("description"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"İşlem açıklaması"}),n.description&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:n.description.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notlar"}),e.jsx("textarea",{...l("notes"),rows:3,className:"w-full rounded border px-3 py-2 text-sm",placeholder:"İşlem ile ilgili notlar..."})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"rounded border px-4 py-2 text-sm hover:bg-gray-50",children:"İptal"}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 rounded bg-primary px-4 py-2 text-sm text-white hover:bg-primary/90",children:[e.jsx(O,{className:"h-4 w-4"}),S?"Güncelle":"Kaydet"]})]})]})]})]})}export{_e as default};
