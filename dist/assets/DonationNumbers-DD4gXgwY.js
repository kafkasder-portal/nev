import{j as e}from"./query-D2a9LsAW.js";import{r as o}from"./vendor-Ba6jih-_.js";import{D as L}from"./DataTable-Dzg2kqPW.js";import{M as v}from"./Modal-BazkrsRl.js";import{e as M}from"./exportToCsv-CTUkvpR5.js";import{L as Q}from"./LazyCameraScanner-CwDC2nGd.js";import{ar as _}from"./ui-yrixFDMZ.js";import"./supabase-B5p9Wfie.js";import"./index-DdeQrtE8.js";import"./router-PzPojOO1.js";const G=[{id:"1",donationNumber:"DN2024001",generatedDate:"2024-01-15",donorName:"Ahmet Yılmaz",donorPhone:"+90 532 123 4567",donorEmail:"ahmet.yilmaz@email.com",purpose:"Eğitim Yardımı",targetAmount:5e3,collectedAmount:3500,currency:"TRY",expiryDate:"2024-06-15",status:"aktif",qrCode:"QR_DN2024001",shortUrl:"https://bagis.org/dn001",usageCount:7,lastUsedDate:"2024-01-14",notes:"Okul öncesi eğitim için",createdBy:"Admin"},{id:"2",donationNumber:"DN2024002",generatedDate:"2024-01-10",purpose:"Genel Bağış",targetAmount:1e4,collectedAmount:1e4,currency:"TRY",expiryDate:"2024-12-31",status:"tamamlandı",qrCode:"QR_DN2024002",shortUrl:"https://bagis.org/dn002",usageCount:25,lastUsedDate:"2024-01-13",notes:"Genel amaçlı bağış kampanyası",createdBy:"Operator1"},{id:"3",donationNumber:"DN2024003",generatedDate:"2024-01-05",donorName:"Zeynep Kaya",donorPhone:"+90 533 987 6543",purpose:"Kurban",targetAmount:2500,collectedAmount:1200,currency:"TRY",expiryDate:"2024-03-01",status:"süresi doldu",qrCode:"QR_DN2024003",shortUrl:"https://bagis.org/dn003",usageCount:3,lastUsedDate:"2024-02-28",createdBy:"Admin"}];function te(){const[i,x]=o.useState(G),[h,D]=o.useState(""),[k,c]=o.useState(!1),[A,b]=o.useState(!1),[u,p]=o.useState(null),[r,S]=o.useState(null),[n,a]=o.useState({donorName:"",donorPhone:"",donorEmail:"",purpose:"",targetAmount:"",currency:"TRY",expiryDate:"",notes:""}),[g,N]=o.useState(!1),l=o.useMemo(()=>i.filter(t=>JSON.stringify(t).toLowerCase().includes(h.toLowerCase())),[i,h]),j=l.reduce((t,s)=>t+s.targetAmount,0),C=l.reduce((t,s)=>t+s.collectedAmount,0),T=l.filter(t=>t.status==="aktif").length,R=l.filter(t=>t.status==="tamamlandı").length,w=[{key:"donationNumber",header:"Bağış No"},{key:"generatedDate",header:"Oluşturma Tarihi"},{key:"donorName",header:"Bağışçı"},{key:"purpose",header:"Amaç"},{key:"targetAmount",header:"Hedef Tutar",render:(t,s)=>`${s.targetAmount.toLocaleString("tr-TR")} ${s.currency}`},{key:"collectedAmount",header:"Toplanan",render:(t,s)=>`${s.collectedAmount.toLocaleString("tr-TR")} ${s.currency}`},{key:"targetAmount",header:"Tamamlanma",render:(t,s)=>{const d=Math.round(s.collectedAmount/s.targetAmount*100);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min(d,100)}%`}})}),e.jsxs("span",{className:"text-sm",children:[d,"%"]})]})}},{key:"usageCount",header:"Kullanım"},{key:"expiryDate",header:"Son Tarih"},{key:"status",header:"Durum",render:(t,s)=>e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.status==="aktif"?"bg-green-100 text-green-800":s.status==="tamamlandı"?"bg-blue-100 text-blue-800":s.status==="süresi doldu"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:s.status})},{key:"id",header:"İşlemler",render:(t,s)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>E(s),className:"text-purple-600 hover:text-purple-800 text-sm",children:"QR Kod"}),e.jsx("button",{onClick:()=>B(s),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Düzenle"}),e.jsx("button",{onClick:()=>$(s.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Sil"})]})}],B=t=>{p(t),a({donorName:t.donorName||"",donorPhone:t.donorPhone||"",donorEmail:t.donorEmail||"",purpose:t.purpose,targetAmount:t.targetAmount.toString(),currency:t.currency,expiryDate:t.expiryDate||"",notes:t.notes||""}),c(!0)},E=t=>{S(t),b(!0)},$=t=>{confirm("Bu bağış numarasını silmek istediğinizden emin misiniz?")&&x(i.filter(s=>s.id!==t))},Y=()=>{const t=new Date().getFullYear(),s=i.length+1;return`DN${t}${s.toString().padStart(3,"0")}`},U=t=>`https://bagis.org/${t.toLowerCase().replace("dn","dn")}`,O=t=>{if(t.preventDefault(),u)x(i.map(s=>s.id===u.id?{...s,...n,targetAmount:parseFloat(n.targetAmount)}:s));else{const s=Y(),d={id:Date.now().toString(),donationNumber:s,generatedDate:new Date().toISOString().split("T")[0],...n,targetAmount:parseFloat(n.targetAmount),collectedAmount:0,status:"aktif",qrCode:`QR_${s}`,shortUrl:U(s),usageCount:0,createdBy:"Admin"};x([...i,d])}c(!1),p(null),y()},y=()=>{a({donorName:"",donorPhone:"",donorEmail:"",purpose:"",targetAmount:"",currency:"TRY",expiryDate:"",notes:""})},P=t=>{t&&(t.donorName!=null&&a(s=>({...s,donorName:t.donorName??s.donorName})),t.donorPhone!=null&&a(s=>({...s,donorPhone:t.donorPhone??s.donorPhone})),t.donorEmail!=null&&a(s=>({...s,donorEmail:t.donorEmail??s.donorEmail})),t.purpose!=null&&a(s=>({...s,purpose:t.purpose??s.purpose})),t.targetAmount!=null&&a(s=>({...s,targetAmount:(t.targetAmount??Number(s.targetAmount||0)).toString()})),t.currency!=null&&a(s=>({...s,currency:["TRY","USD","EUR"].includes(t.currency)?t.currency:s.currency})),t.expiryDate!=null&&a(s=>({...s,expiryDate:t.expiryDate??s.expiryDate})),t.notes!=null&&a(s=>({...s,notes:t.notes??s.notes})),t.firstName&&t.lastName&&a(s=>({...s,donorName:`${t.firstName} ${t.lastName}`})),t.phone&&a(s=>({...s,donorPhone:t.phone||""})),t.idNumber&&a(s=>({...s,notes:s.notes?`${s.notes} | TC: ${t.idNumber}`:`TC: ${t.idNumber}`})),t.passportNumber&&a(s=>({...s,notes:s.notes?`${s.notes} | Pasaport: ${t.passportNumber}`:`Pasaport: ${t.passportNumber}`})),t.address&&a(s=>({...s,notes:s.notes?`${s.notes} | Adres: ${t.address}`:`Adres: ${t.address}`})),t.birthDate&&a(s=>({...s,notes:s.notes?`${s.notes} | Doğum: ${t.birthDate}`:`Doğum: ${t.birthDate}`})),N(!1))},K=()=>{p(null),y(),c(!0)},f=t=>{navigator.clipboard.writeText(t),alert("Panoya kopyalandı!")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Bağış Numaraları"}),e.jsx("button",{onClick:K,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Yeni Bağış Numarası"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-600",children:"Toplam Numara"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:l.length})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-green-600",children:"Aktif"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:T})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-purple-600",children:"Tamamlanan"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:R})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-orange-600",children:"Toplama Oranı"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-900",children:[j>0?Math.round(C/j*100):0,"%"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Durum Dağılımı"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:["aktif","tamamlandı","süresi doldu","iptal"].map(t=>{const s=l.filter(m=>m.status===t).length,d=l.filter(m=>m.status===t).reduce((m,z)=>m+z.collectedAmount,0);return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium capitalize",children:t}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s," numara"]}),e.jsxs("p",{className:"text-lg font-bold",children:[d.toLocaleString("tr-TR")," ₺"]})]},t)})})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("input",{value:h,onChange:t=>D(t.target.value),className:"flex-1 border rounded px-3 py-2",placeholder:"Bağış no, bağışçı, amaç ile ara..."}),e.jsxs("select",{className:"border rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"Tüm Durumlar"}),e.jsx("option",{value:"aktif",children:"Aktif"}),e.jsx("option",{value:"tamamlandı",children:"Tamamlandı"}),e.jsx("option",{value:"süresi doldu",children:"Süresi Doldu"}),e.jsx("option",{value:"iptal",children:"İptal"})]}),e.jsxs("select",{className:"border rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"Tüm Amaçlar"}),e.jsx("option",{value:"Genel Bağış",children:"Genel Bağış"}),e.jsx("option",{value:"Eğitim Yardımı",children:"Eğitim Yardımı"}),e.jsx("option",{value:"Sağlık Yardımı",children:"Sağlık Yardımı"}),e.jsx("option",{value:"Kurban",children:"Kurban"}),e.jsx("option",{value:"Ramazan",children:"Ramazan"})]}),e.jsx("input",{type:"date",className:"border rounded px-3 py-2",placeholder:"Başlangıç tarihi"}),e.jsx("button",{onClick:()=>M("bagis-numaralari.csv",l),className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Excel İndir"})]}),e.jsx(L,{columns:w,data:l})]}),e.jsxs(v,{isOpen:k,onClose:()=>c(!1),title:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:u?"Bağış Numarası Düzenle":"Yeni Bağış Numarası"}),e.jsxs("button",{type:"button",onClick:()=>N(!g),className:"flex items-center gap-2 px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700",children:[e.jsx(_,{size:16}),g?"Kamerayı Kapat":"Kamera Tara"]})]}),children:[g&&e.jsx("div",{className:"mb-4",children:e.jsx(Q,{onScanResult:P,onError:t=>console.error("Tarama hatası:",t)})}),e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bağışçı Adı (Opsiyonel)"}),e.jsx("input",{type:"text",value:n.donorName,onChange:t=>a({...n,donorName:t.target.value}),className:"w-full border rounded px-3 py-2",placeholder:"Belirli bir bağışçı için"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Telefon"}),e.jsx("input",{type:"tel",value:n.donorPhone,onChange:t=>a({...n,donorPhone:t.target.value}),className:"w-full border rounded px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"E-posta"}),e.jsx("input",{type:"email",value:n.donorEmail,onChange:t=>a({...n,donorEmail:t.target.value}),className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bağış Amacı"}),e.jsxs("select",{value:n.purpose,onChange:t=>a({...n,purpose:t.target.value}),className:"w-full border rounded px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Seçiniz"}),e.jsx("option",{value:"Genel Bağış",children:"Genel Bağış"}),e.jsx("option",{value:"Eğitim Yardımı",children:"Eğitim Yardımı"}),e.jsx("option",{value:"Sağlık Yardımı",children:"Sağlık Yardımı"}),e.jsx("option",{value:"Gıda Yardımı",children:"Gıda Yardımı"}),e.jsx("option",{value:"Kurban",children:"Kurban"}),e.jsx("option",{value:"Ramazan",children:"Ramazan"}),e.jsx("option",{value:"Diğer",children:"Diğer"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hedef Tutar"}),e.jsx("input",{type:"number",step:"0.01",value:n.targetAmount,onChange:t=>a({...n,targetAmount:t.target.value}),className:"w-full border rounded px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Para Birimi"}),e.jsxs("select",{value:n.currency,onChange:t=>a({...n,currency:t.target.value}),className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"TRY",children:"TRY"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Son Kullanım Tarihi (Opsiyonel)"}),e.jsx("input",{type:"date",value:n.expiryDate,onChange:t=>a({...n,expiryDate:t.target.value}),className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notlar"}),e.jsx("textarea",{value:n.notes,onChange:t=>a({...n,notes:t.target.value}),className:"w-full border rounded px-3 py-2",rows:3,placeholder:"Bağış numarası hakkında ek bilgiler..."})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 border rounded hover:bg-gray-50",children:"İptal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:u?"Güncelle":"Oluştur"})]})]})]}),e.jsx(v,{isOpen:A,onClose:()=>b(!1),title:"QR Kod ve Bağış Linki",children:r&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:r.donationNumber}),e.jsx("p",{className:"text-gray-600 mb-4",children:r.purpose}),e.jsx("div",{className:"w-48 h-48 mx-auto bg-gray-100 border-2 border-dashed border-gray-300 flex items-center justify-center mb-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📱"}),e.jsx("div",{className:"text-sm text-gray-500",children:"QR Kod"}),e.jsx("div",{className:"text-xs text-gray-400",children:r.qrCode})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bağış Linki"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:r.shortUrl,readOnly:!0,className:"flex-1 border rounded px-3 py-2 bg-gray-50"}),e.jsx("button",{onClick:()=>f(r.shortUrl),className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Kopyala"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hedef Tutar"}),e.jsxs("div",{className:"text-lg font-bold",children:[r.targetAmount.toLocaleString("tr-TR")," ",r.currency]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Toplanan"}),e.jsxs("div",{className:"text-lg font-bold text-green-600",children:[r.collectedAmount.toLocaleString("tr-TR")," ",r.currency]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kullanım Sayısı"}),e.jsx("div",{className:"text-lg font-bold",children:r.usageCount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Son Kullanım"}),e.jsx("div",{className:"text-sm",children:r.lastUsedDate||"Henüz kullanılmadı"})]})]}),r.expiryDate&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Son Tarih"}),e.jsx("div",{className:"text-sm",children:r.expiryDate})]})]}),e.jsxs("div",{className:"flex justify-center gap-2 pt-4",children:[e.jsx("button",{onClick:()=>window.open(r.shortUrl,"_blank"),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Bağış Sayfasını Aç"}),e.jsx("button",{onClick:()=>f(r.shortUrl),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Linki Paylaş"})]})]})})]})}export{te as default};
