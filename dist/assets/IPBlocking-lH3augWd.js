import{j as e}from"./query-D2a9LsAW.js";import{r as i}from"./vendor-Ba6jih-_.js";import{D as S}from"./DataTable-Dzg2kqPW.js";import{e as M}from"./exportToCsv-CTUkvpR5.js";import{ab as D,H as E,Z as C,ao as L,aT as O,am as B,ax as P}from"./ui-yrixFDMZ.js";const z=[{id:"1",ipAddress:"192.168.48.44",reason:"nurettin nicki ile giriş yapmaya çalışan kullanıcının hatalı giriş denemesinden dolayı ip engellemesi",blockedDate:"12.05.2025 04:43:51",blockedBy:"Sistem (Otomatik)",attempts:15,lastAttempt:"12.05.2025 04:42:30",blockType:"Automatic",expiryDate:"19.05.2025 04:43:51",country:"Türkiye",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",severity:"High",status:"Active"},{id:"2",ipAddress:"85.34.12.45",reason:"Şüpheli SQL injection denemeleri",blockedDate:"10.05.2025 14:22:10",blockedBy:"Ahmet Yılmaz",attempts:8,lastAttempt:"10.05.2025 14:20:45",blockType:"Manual",expiryDate:null,country:"Rusya",userAgent:"curl/7.68.0",severity:"Critical",status:"Active"},{id:"3",ipAddress:"172.29.188.109",reason:"Çoklu başarısız giriş denemesi",blockedDate:"08.05.2025 16:30:22",blockedBy:"Sistem (Otomatik)",attempts:12,lastAttempt:"08.05.2025 16:29:55",blockType:"Temporary",expiryDate:"09.05.2025 16:30:22",country:"Türkiye",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_0)",severity:"Medium",status:"Expired"},{id:"4",ipAddress:"195.142.86.72",reason:"Brute force saldırı tespiti",blockedDate:"05.05.2025 09:15:33",blockedBy:"Fatma Demir",attempts:25,lastAttempt:"05.05.2025 09:14:12",blockType:"Manual",expiryDate:null,country:"Çin",userAgent:"python-requests/2.25.1",severity:"Critical",status:"Active"},{id:"5",ipAddress:"192.168.1.100",reason:"Test amaçlı manuel engelleme",blockedDate:"01.05.2025 10:00:00",blockedBy:"Mehmet Öz",attempts:3,lastAttempt:"01.05.2025 09:58:30",blockType:"Manual",expiryDate:null,country:"Türkiye",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",severity:"Low",status:"Whitelist"}];function Y(){const[n,h]=i.useState(""),[b,u]=i.useState(!1),[d,y]=i.useState("all"),[c,j]=i.useState("all"),[o,k]=i.useState("all"),a=i.useMemo(()=>{let t=z;return d!=="all"&&(t=t.filter(s=>s.blockType===d)),c!=="all"&&(t=t.filter(s=>s.status===c)),o!=="all"&&(t=t.filter(s=>s.severity===o)),n&&(t=t.filter(s=>JSON.stringify(s).toLowerCase().includes(n.toLowerCase()))),t},[n,d,c,o]),N=[{key:"ipAddress",header:"IP Adresi",render:t=>e.jsx("span",{className:"font-mono text-sm",children:String(t||"")})},{key:"reason",header:"Engelleme Nedeni",render:t=>e.jsx("div",{className:"max-w-xs",children:e.jsx("p",{className:"text-sm truncate",title:String(t||""),children:String(t||"")})})},{key:"blockType",header:"Engelleme Tipi",render:t=>{const s={Manual:"bg-blue-100 text-blue-700",Automatic:"bg-green-100 text-green-700",Temporary:"bg-yellow-100 text-yellow-700"},l={Manual:"Manuel",Automatic:"Otomatik",Temporary:"Geçici"},r=String(t||"Manual");return e.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${s[r]||s.Manual}`,children:l[r]||l.Manual})}},{key:"severity",header:"Önem",render:t=>{const s={Low:"bg-gray-100 text-gray-700",Medium:"bg-yellow-100 text-yellow-700",High:"bg-orange-100 text-orange-700",Critical:"bg-red-100 text-red-700"},l={Low:"Düşük",Medium:"Orta",High:"Yüksek",Critical:"Kritik"},r=String(t||"Low");return e.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${s[r]||s.Low}`,children:l[r]||l.Low})}},{key:"attempts",header:"Deneme Sayısı"},{key:"country",header:"Ülke"},{key:"blockedDate",header:"Engellenme Tarihi"},{key:"status",header:"Durum",render:t=>{const s={Active:"bg-red-100 text-red-700",Expired:"bg-gray-100 text-gray-700",Whitelist:"bg-green-100 text-green-700"},l={Active:"Aktif",Expired:"Süresi Dolmuş",Whitelist:"Beyaz Liste"},r=String(t||"Active");return e.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${s[r]||s.Active}`,children:l[r]||l.Active})}},{key:"actions",header:"İşlemler",render:(t,s)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"rounded p-1 text-gray-600 hover:bg-gray-50",title:"Detay",children:e.jsx(L,{className:"h-4 w-4"})}),s.status==="Active"?e.jsx("button",{className:"rounded p-1 text-green-600 hover:bg-green-50",title:"Engeli Kaldır",children:e.jsx(O,{className:"h-4 w-4"})}):e.jsx("button",{className:"rounded p-1 text-red-600 hover:bg-red-50",title:"Engelle",children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx("button",{className:"rounded p-1 text-red-600 hover:bg-red-50",title:"Sil",children:e.jsx(P,{className:"h-4 w-4"})})]})}],g=["Manual","Automatic","Temporary"],f=["Active","Expired","Whitelist"],p=["Low","Medium","High","Critical"],v=a.filter(t=>t.status==="Active").length,w=a.filter(t=>t.severity==="Critical").length,A=a.reduce((t,s)=>t+s.attempts,0),T=new Set(a.map(t=>t.country)).size;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto rounded border p-2",children:[e.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 rounded bg-red-600 px-3 py-1 text-sm text-white",children:[e.jsx(D,{className:"h-4 w-4"}),"IP Engelle"]}),e.jsxs("select",{value:d,onChange:t=>y(t.target.value),className:"rounded border bg-background px-2 py-1 text-sm",children:[e.jsx("option",{value:"all",children:"Tüm Tipler"}),g.map(t=>e.jsx("option",{value:t,children:t==="Manual"?"Manuel":t==="Automatic"?"Otomatik":"Geçici"},t))]}),e.jsxs("select",{value:c,onChange:t=>j(t.target.value),className:"rounded border bg-background px-2 py-1 text-sm",children:[e.jsx("option",{value:"all",children:"Tüm Durumlar"}),f.map(t=>e.jsx("option",{value:t,children:t==="Active"?"Aktif":t==="Expired"?"Süresi Dolmuş":"Beyaz Liste"},t))]}),e.jsxs("select",{value:o,onChange:t=>k(t.target.value),className:"rounded border bg-background px-2 py-1 text-sm",children:[e.jsx("option",{value:"all",children:"Tüm Önem Seviyeleri"}),p.map(t=>e.jsx("option",{value:t,children:t==="Low"?"Düşük":t==="Medium"?"Orta":t==="High"?"Yüksek":"Kritik"},t))]}),e.jsx("input",{value:n,onChange:t=>h(t.target.value),className:"min-w-64 flex-1 rounded border px-2 py-1 text-sm",placeholder:"IP adresi, neden veya ülke ara..."}),e.jsx("button",{className:"rounded bg-blue-600 px-3 py-1 text-sm text-white",children:"Ara"}),e.jsx("button",{onClick:()=>M("ip-engelleme-savunma.csv",a),className:"rounded bg-gray-600 px-3 py-1 text-sm text-white",children:"İndir"}),e.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[a.length," Engellenmiş IP"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded border bg-card dark:bg-gray-800 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5 text-red-600"}),e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Aktif Engeller"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:v})]}),e.jsxs("div",{className:"rounded border bg-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5 text-orange-600"}),e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Kritik Tehditler"})]}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:w})]}),e.jsxs("div",{className:"rounded border bg-card p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Toplam Deneme"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:A})]}),e.jsxs("div",{className:"rounded border bg-card p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Ülke Sayısı"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:T})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded border bg-card p-4",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:"Tehdit Seviyeleri"}),e.jsx("div",{className:"space-y-2",children:p.map(t=>{const s=a.filter(x=>x.severity===t).length,l=a.length>0?(s/a.length*100).toFixed(1):0,r=t==="Low"?"Düşük":t==="Medium"?"Orta":t==="High"?"Yüksek":"Kritik",m=t==="Low"?"bg-gray-500":t==="Medium"?"bg-yellow-500":t==="High"?"bg-orange-500":"bg-red-500";return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:r}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-20 rounded bg-gray-200",children:e.jsx("div",{className:`h-full rounded ${m}`,style:{width:`${l}%`}})}),e.jsxs("span",{className:"text-sm font-medium",children:[s," (%",l,")"]})]})]},t)})})]}),e.jsxs("div",{className:"rounded border bg-card p-4",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:"Engelleme Türleri"}),e.jsx("div",{className:"space-y-2",children:g.map(t=>{const s=a.filter(x=>x.blockType===t).length,l=a.length>0?(s/a.length*100).toFixed(1):0,r=t==="Manual"?"Manuel":t==="Automatic"?"Otomatik":"Geçici",m=t==="Manual"?"bg-blue-500":t==="Automatic"?"bg-green-500":"bg-yellow-500";return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:r}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-20 rounded bg-gray-200",children:e.jsx("div",{className:`h-full rounded ${m}`,style:{width:`${l}%`}})}),e.jsxs("span",{className:"text-sm font-medium",children:[s," (%",l,")"]})]})]},t)})})]})]}),e.jsx(S,{columns:N,data:a}),b&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"w-full max-w-lg rounded-lg bg-white dark:bg-gray-800 p-6",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100",children:"IP Adresi Engelle"}),e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"IP Adresi"}),e.jsx("input",{type:"text",className:"mt-1 w-full rounded border px-3 py-2 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600",placeholder:"192.168.1.10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Engelleme Nedeni"}),e.jsx("textarea",{className:"mt-1 w-full rounded border px-3 py-2 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600",rows:3,placeholder:"Engelleme nedenini açıklayın..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Engelleme Tipi"}),e.jsxs("select",{className:"mt-1 w-full rounded border px-3 py-2 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600",children:[e.jsx("option",{value:"Manual",children:"Manuel"}),e.jsx("option",{value:"Automatic",children:"Otomatik"}),e.jsx("option",{value:"Temporary",children:"Geçici"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Önem Seviyesi"}),e.jsxs("select",{className:"mt-1 w-full rounded border px-3 py-2 text-sm",children:[e.jsx("option",{value:"Low",children:"Düşük"}),e.jsx("option",{value:"Medium",children:"Orta"}),e.jsx("option",{value:"High",children:"Yüksek"}),e.jsx("option",{value:"Critical",children:"Kritik"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Son Erişim Tarihi (Opsiyonel)"}),e.jsx("input",{type:"datetime-local",className:"mt-1 w-full rounded border px-3 py-2 text-sm"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Deneme Sayısı"}),e.jsx("input",{type:"number",className:"mt-1 w-full rounded border px-3 py-2 text-sm",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Ülke (Opsiyonel)"}),e.jsx("input",{type:"text",className:"mt-1 w-full rounded border px-3 py-2 text-sm",placeholder:"Türkiye"})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"rounded"}),"Kalıcı engelleme (Son kullanma tarihi yok)"]})}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 rounded border px-4 py-2 text-sm",children:"İptal"}),e.jsx("button",{type:"submit",className:"flex-1 rounded bg-red-600 px-4 py-2 text-sm text-white",children:"Engelle"})]})]})]})})]})}export{Y as default};
